{% extends "base.html" %}

{% block content %}
<div class="upload-section">
    <h2>Upload New Image</h2>
    <form method="POST" enctype="multipart/form-data" class="upload-form">
        {{ form.hidden_tag() }}
        
        <div class="form-group">
            {{ form.image.label }}
            {{ form.image(class="form-control-file") }}
            {% if form.image.errors %}
                <div class="error-messages">
                    {% for error in form.image.errors %}
                        <span class="error">{{ error }}</span>
                    {% endfor %}
                </div>
            {% endif %}
        </div>
        
        <div class="form-group">
            {{ form.description.label }}
            {{ form.description(class="form-control", rows="3", placeholder="Optional description...") }}
            {% if form.description.errors %}
                <div class="error-messages">
                    {% for error in form.description.errors %}
                        <span class="error">{{ error }}</span>
                    {% endfor %}
                </div>
            {% endif %}
        </div>
        
        <button type="submit" class="btn btn-primary">Upload Image</button>
    </form>
</div>

<div class="gallery-section">
    <h2>Image Gallery</h2>
    
    {% if images %}
        <div class="image-grid">
            {% for image in images %}
                <div class="image-card">
                    <div class="image-container">
                        <img src="{{ url_for('uploaded_file', filename=image.filename) }}" 
                             alt="{{ image.original_filename }}"
                             loading="lazy">
                    </div>
                    <div class="image-info">
                        <h3>{{ image.original_filename }}</h3>
                        {% if image.description %}
                            <p class="description">{{ image.description }}</p>
                        {% endif %}
                        <div class="image-meta">
                            <span class="file-size">{{ (image.file_size / 1024) | round(2) }} KB</span>
                            <span class="upload-date">{{ image.upload_date.strftime('%d.%m.%Y %H:%M') }}</span>
                        </div>
                        <form method="POST" action="{{ url_for('delete_image', image_id=image.id) }}" 
                              onsubmit="return confirm('Are you sure you want to delete this image?');">
                            <button type="submit" class="btn btn-danger btn-small">Delete</button>
                        </form>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="empty-gallery">
            <p>No images uploaded yet. Be the first to upload!</p>
        </div>
    {% endif %}
</div>
{% endblock %}
